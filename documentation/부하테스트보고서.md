# **부하 테스트 대상 선정 및 계획**

## **1. 부하 테스트 대상**

### 선정된 API:

1. **주문 요청**: `POST /order-service/api/orders`
2. **인기주문상품 목록 조회**: `GET /order-service/api/orders/popular`

## **2. 대상 선정 이유**

### **1) 주문 요청 (POST /order-service/api/orders)**

- **중요도**:
    - 이커머스 시스템에서 가장 중요한 API로, 실패 시 비즈니스 신뢰도에 큰 영향을 미침.
- **트래픽 패턴**:
    - 세일, 이벤트, 프로모션 등 대량 주문이 발생할 가능성이 높음.
- **복잡성**:
    - 재고 확인, 결제 처리, 포인트 차감 등 여러 서비스와의 연동 작업이 포함됨.

### **2) 상품 목록 조회 (GET /order-service/api/orders/popular)**

- **중요도**:
    - 사용자 경험에 직결된 API로 가장 자주 호출됨.
- **트래픽 집중도**:
    - 메인 페이지 및 검색 기능에서 가장 많이 발생하는 요청.
- **캐싱 및 최적화 필요성**:
    - 데이터 조회 및 필터링 과정에서의 병목 가능성을 사전 검증.

## **3. 부하 테스트 목적**

1. **시스템 성능 확인**:
    - 정상 트래픽 및 피크 트래픽 상황에서 시스템이 안정적으로 동작하는지 확인.
2. **확장성 검증**:
    - 서버 자원(CPU, 메모리 등)의 한계치를 파악하여 트래픽 증가에 대비.
3. **안정성 확인**:
    - 급격한 트래픽 증가 상황에서도 시스템이 다운되지 않고 대처할 수 있는지 평가.
4. **장애 대응 전략 수립**:
    - 병목 구간을 식별하고, 최적화 및 장애 대응 계획을 수립.

## **4. 부하 테스트 시나리오**

### **1) 주문 요청 (POST /order-service/api/orders)**

- **테스트 조건**:
    - **요청량**: 10초에 1,000건의 주문 요청.
    - **요청 데이터**: 랜덤하게 생성된 상품 ID와 사용자 정보 포함.
    - **테스트 환경**:
        - 여러 클라이언트에서 동시에 요청을 전송.
- **시나리오 선정 이유**:
    - 프로모션 이벤트나 한정판 상품 판매 상황을 시뮬레이션.
    - 데이터베이스 동기화 및 데이터 정합성 확인.
    - 대량 주문 요청에서 병목 현상을 파악.

### **2) 상품 목록 조회 (GET /order-service/api/orders/popular)**

- **테스트 조건**:
    - **요청량**: 1초에 2,000건의 상품 목록 조회 요청.
    - **요청 데이터**: 다양한 필터 조건(카테고리, 가격대 등)을 사용.
    - **테스트 환경**:
        - 여러 디바이스와 네트워크 환경에서 요청을 발생.
- **시나리오 선정 이유**:
    - 가장 빈번히 호출되는 API로, 대규모 트래픽 대응 필요.
    - 캐싱 전략 검증 및 서버 부하 분산 확인.
    - 사용자 경험 최적화를 위한 성능 안정성 확보.

# **부하 테스트 결과 분석**

## **1. 주문 요청 결과 분석**

- 요청량
  ![image](https://github.com/user-attachments/assets/3bfe1a1f-0cd7-4635-b672-f1f2371f7689)

- 요청 정보
  ![image](https://github.com/user-attachments/assets/83ff21fc-9e9e-41ef-bf83-2687f401a84a)

- 요청 결과
  ![image](https://github.com/user-attachments/assets/0c640f3f-eaa4-4cbc-8b13-377a9117e8fb)

### **테스트 조건**

- **Thread (Users)**: 1,000명
- **Ramp-up Period**: 10초 (1,000명의 사용자가 동시에 요청)
- **HTTP Request**: `POST /order-service/api/orders`
- **Body Data**: 각 주문 요청에 다수의 상품 (`productId`, `amount`) 포함

### **결과 요약**

| 항목                    | 값          |
|-----------------------|------------|
| **요청 수 (Samples)**    | 1,010건     |
| **평균 응답 시간**          | 2,603ms    |
| **최소 응답 시간**          | 97ms       |
| **최대 응답 시간**          | 6,553ms    |
| **표준 편차 (Std. Dev.)** | 1,317.41ms |
| **에러율**               | 0.10%      |
| **처리량 (Throughput)**  | 4.2/sec    |

### **분석**

1. **응답 시간**:
    - 평균 응답 시간은 2.6초로 다소 느림.
    - 최대 응답 시간이 6.5초로 일부 요청에서 심각한 지연 발생.
    - 표준 편차(1,317ms)가 높아 응답 시간의 변동 폭이 큼.
2. **처리량**:
    - 초당 4.2건으로 예상 트래픽 대비 처리량 부족.
3. **에러율**:
    - 에러율이 0.1%로 낮지만, 트래픽 증가에 따른 안정성 확보 필요.
4. **병목 구간 추정**:
    - 재고 확인, 결제 처리 등 다중 서비스 연동 단계에서 지연 가능성 존재.
    - 데이터베이스 동시 처리 한계 또는 트랜잭션 처리 문제 가능.

## **2. 상품 목록 조회 결과 분석**

- 요청량
  ![image](https://github.com/user-attachments/assets/a6a5fe6f-0641-402d-a9fd-ec13dac20f21)
- 요청 정보
  ![image](https://github.com/user-attachments/assets/21445778-8f50-4601-87f7-9b6ac03fddc5)
- 요청 결과
  ![image](https://github.com/user-attachments/assets/2c29da80-4287-4d34-b06c-f94e407b8f12)

### **테스트 조건**

- **Thread (Users)**: 2,000명
- **Ramp-up Period**: 1초 (2,000명의 사용자가 동시에 요청)
- **HTTP Request**: `GET /order-service/api/orders/popular`

### **결과 요약**

| 항목                    | 값        |
|-----------------------|----------|
| **요청 수 (Samples)**    | 2,000건   |
| **평균 응답 시간**          | 133ms    |
| **최소 응답 시간**          | 4ms      |
| **최대 응답 시간**          | 733ms    |
| **표준 편차 (Std. Dev.)** | 198.79ms |
| **에러율**               | 0.00%    |
| **처리량 (Throughput)**  | 841/sec  |

### **분석**

1. **응답 시간**:
    - 평균 응답 시간은 133ms로 매우 빠르고, 최대 응답 시간도 733ms로 양호.
    - 표준 편차가 높아 일부 요청에서 응답 시간이 길어지는 현상 확인.
2. **처리량**:
    - 초당 841건의 요청을 안정적으로 처리.
    - 캐싱 전략 및 서버 확장성이 잘 구현된 것으로 보임.
3. **에러율**:
    - 에러율이 0.00%로 모든 요청이 성공적으로 처리됨.
4. **성공 요인**:
    - 캐싱 활용 및 응답 데이터 최적화가 성능 개선에 기여한 것으로 추정.

## **3. 종합 평가 및 개선 방향**

### **1) 주문 요청 API**

#### **문제점**

- 응답 시간이 느리고 변동 폭이 큼.
- 처리량이 낮아 높은 트래픽 상황에서 안정성이 부족.

#### **개선 방안**

1. **비동기 처리**:
    - 주문 처리 과정을 비동기로 분리하여 응답 시간 단축.
2. **데이터베이스 최적화**:
    - 데이터베이스 쿼리 최적화 및 인덱싱 검토.
3. **서비스 분리**:
    - 재고 확인, 결제 등을 마이크로서비스로 분리하여 병목 제거.
4. **캐싱 활용**:
    - 재고 데이터 및 자주 사용되는 정보에 대한 캐싱 도입.

### **2) 상품 목록 조회 API**

#### **강점**

- 높은 처리량과 낮은 응답 시간으로 대규모 트래픽에도 안정적으로 동작.

#### **개선 방안**

1. **캐싱 적중률 분석**:
    - 응답 데이터의 캐싱 적중률을 추가 분석하여 최적화.
2. **변동 폭 줄이기**:
    - 표준 편차가 높은 원인을 파악하고 응답 시간 안정성을 강화.

## **4. 결론**

- **주문 요청 API**:
    - 병목 구간을 파악하고 비동기 처리, 데이터베이스 최적화 등으로 성능 개선 필요.
    - 이벤트 트래픽 증가에 대비한 확장성 확보 필수.
- **상품 목록 조회 API**:
    - 현재 성능은 우수하지만, 캐싱 최적화 및 응답 시간 변동 감소로 더욱 안정성을 강화 가능.